(function(e){function t(t){for(var s,n,r=t[0],l=t[1],c=t[2],d=0,u=[];d<r.length;d++)n=r[d],Object.prototype.hasOwnProperty.call(i,n)&&i[n]&&u.push(i[n][0]),i[n]=0;for(s in l)Object.prototype.hasOwnProperty.call(l,s)&&(e[s]=l[s]);m&&m(t);while(u.length)u.shift()();return o.push.apply(o,c||[]),a()}function a(){for(var e,t=0;t<o.length;t++){for(var a=o[t],s=!0,n=1;n<a.length;n++){var r=a[n];0!==i[r]&&(s=!1)}s&&(o.splice(t--,1),e=l(l.s=a[0]))}return e}var s={},n={index:0},i={index:0},o=[];function r(e){return l.p+"js/"+({about:"about",home:"home",ids:"ids",test:"test",viewer:"viewer"}[e]||e)+"."+{about:"39d29153",home:"308c95a1",ids:"6bf97b59",test:"402636fe",viewer:"9131281a"}[e]+".js"}function l(t){if(s[t])return s[t].exports;var a=s[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,l),a.l=!0,a.exports}l.e=function(e){var t=[],a={about:1,home:1,ids:1,test:1,viewer:1};n[e]?t.push(n[e]):0!==n[e]&&a[e]&&t.push(n[e]=new Promise((function(t,a){for(var s="css/"+({about:"about",home:"home",ids:"ids",test:"test",viewer:"viewer"}[e]||e)+"."+{about:"ce42b287",home:"989246da",ids:"b10ffd9a",test:"c433e3f5",viewer:"d4411ddf"}[e]+".css",i=l.p+s,o=document.getElementsByTagName("link"),r=0;r<o.length;r++){var c=o[r],d=c.getAttribute("data-href")||c.getAttribute("href");if("stylesheet"===c.rel&&(d===s||d===i))return t()}var u=document.getElementsByTagName("style");for(r=0;r<u.length;r++){c=u[r],d=c.getAttribute("data-href");if(d===s||d===i)return t()}var m=document.createElement("link");m.rel="stylesheet",m.type="text/css",m.onload=t,m.onerror=function(t){var s=t&&t.target&&t.target.src||i,o=new Error("Loading CSS chunk "+e+" failed.\n("+s+")");o.code="CSS_CHUNK_LOAD_FAILED",o.request=s,delete n[e],m.parentNode.removeChild(m),a(o)},m.href=i;var p=document.getElementsByTagName("head")[0];p.appendChild(m)})).then((function(){n[e]=0})));var s=i[e];if(0!==s)if(s)t.push(s[2]);else{var o=new Promise((function(t,a){s=i[e]=[t,a]}));t.push(s[2]=o);var c,d=document.createElement("script");d.charset="utf-8",d.timeout=120,l.nc&&d.setAttribute("nonce",l.nc),d.src=r(e);var u=new Error;c=function(t){d.onerror=d.onload=null,clearTimeout(m);var a=i[e];if(0!==a){if(a){var s=t&&("load"===t.type?"missing":t.type),n=t&&t.target&&t.target.src;u.message="Loading chunk "+e+" failed.\n("+s+": "+n+")",u.name="ChunkLoadError",u.type=s,u.request=n,a[1](u)}i[e]=void 0}};var m=setTimeout((function(){c({type:"timeout",target:d})}),12e4);d.onerror=d.onload=c,document.head.appendChild(d)}return Promise.all(t)},l.m=e,l.c=s,l.d=function(e,t,a){l.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},l.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},l.t=function(e,t){if(1&t&&(e=l(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(l.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)l.d(a,s,function(t){return e[t]}.bind(null,s));return a},l.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return l.d(t,"a",t),t},l.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},l.p="/aereo/",l.oe=function(e){throw console.error(e),e};var c=window["webpackJsonp"]=window["webpackJsonp"]||[],d=c.push.bind(c);c.push=t,c=c.slice();for(var u=0;u<c.length;u++)t(c[u]);var m=d;o.push([0,"chunk-vendors"]),a()})({0:function(e,t,a){e.exports=a("cd49")},"5c0b":function(e,t,a){"use strict";var s=a("9c0c"),n=a.n(s);n.a},"9c0c":function(e,t,a){},cd49:function(e,t,a){"use strict";a.r(t);var s=a("2b0e"),n=a("b71a"),i=a.n(n),o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"app"}},[a("router-view"),a("div",{attrs:{id:"dialog-root"}})],1)},r=[],l=(a("5c0b"),a("2877")),c={},d=Object(l["a"])(c,o,r,!1,null,null,null),u=d.exports,m=a("8c4f");s["default"].use(m["a"]);const p=[{path:"/gen/ids",name:"Ids",meta:{title:"Generate ID Lists"},component:()=>a.e("ids").then(a.bind(null,"d4eb"))},{path:"/test",name:"Test",meta:{title:"Test"},component:()=>a.e("test").then(a.bind(null,"78c1"))},{path:"/",name:"Home",component:()=>a.e("home").then(a.bind(null,"bb51"))},{path:"/about",name:"About",component:()=>a.e("about").then(a.bind(null,"f820"))},{path:"/viewer",name:"Viewer",meta:{title:"Aereo | a DX Lab project",metaTags:[{name:"description",content:"A broad-based and serendipitous exploration of the Library’s collection."},{property:"viewport",content:"width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0"}]},component:()=>a.e("viewer").then(a.bind(null,"e1b1"))}],h=new m["a"]({base:"/aereo/",routes:p});h.beforeEach((e,t,a)=>{const s=e.matched.slice().reverse().find(e=>e.meta&&e.meta.title),n=e.matched.slice().reverse().find(e=>e.meta&&e.meta.metaTags);if(s&&(document.title=s.meta.title),Array.from(document.querySelectorAll("[data-vue-router-controlled]")).map(e=>e.parentNode?e.parentNode.removeChild(e):null),!n)return a();n.meta.metaTags.map(e=>{const t=document.createElement("meta");return Object.keys(e).forEach(a=>{t.setAttribute(a,e[a])}),t.setAttribute("data-vue-router-controlled",""),t}).forEach(e=>document.head.appendChild(e)),a()});var f=h,g=a("9ab4"),y=a("2f62"),b=a("955d"),v=a.n(b),w=a("4d7c"),k=a.n(w),j=a("5a89");function A(){const e=j["Cache"];e.enabled=!0;const t=new j["TextureLoader"],a=new j["FileLoader"];function s(s,n,i,o){const r=e.get(s);function l(){t.load(s,n,()=>{},o)}function c(t){const a=URL.createObjectURL(t),n=document.createElementNS("http://www.w3.org/1999/xhtml","img");n.onload=()=>{e.add(s,n),URL.revokeObjectURL(a),document.body.removeChild(n),l()},n.src=a,n.style.visibility="hidden",n.style.width=0,n.style.height=0,document.body.appendChild(n)}if(r)return r;a.load(s,c,i,o)}return a.setResponseType("blob"),Object.assign({},t,{load:s})}var O=A;const _={archTechDrawings:{key:"archTechDrawings",id:"m6zK940qx9v7K",name:"architectural\ndrawings",description:"Drawings made for the design and construction of sites, structures, details, fixtures, furnishings, and decorations, as well as other objects designed by an architect or architectural office."},newspapers:{key:"newspapers",id:"76pM49Z2jxBzR",name:"newspapers",description:""},coin:{key:"coin",id:"76pM49Z2jxBzR",name:"coins",description:"Flat discs with an official stamp used as money."},drawings:{key:"drawings",id:"GP85pXKPWzzB",name:"drawings",description:""},ephemera:{key:"ephemera",id:"vz2D0Am8wvrlb",name:"ephemera",description:"Materials, usually printed documents, created for a specific, limited purpose, and generally designed to be discarded after use."},journals:{key:"journals",id:"Z5AB0OkPYjPb9",name:"journals",description:"Publications issued over a period of time, such as newsletters and magazines. Often may be called yearbooks, journals, annual reports, newsletters, magazines, periodicals, gazettes and so forth."},manuscripts:{key:"manuscripts",id:"330MWgKgY5adZ",name:"manuscripts",description:"Unpublished documents and records accumulated by agencies and people, usually handwritten however can be transcript, includes documents, books, letters etc."},manuscriptMaps:{key:"manuscriptMaps",id:"Xp1qba0O2k32v",name:"unpublished\nmaps",description:"Hand drawn maps or the original drawing of a map as compiled or constructed from various data, such as ground surveys and photographs."},maps:{key:"maps",id:"40XObXd7aA4a",name:"published   \nmaps",description:"Published graphic representations of areas of land or sea or another celestial sphere indicating the relative position of artificial and natural features according to a scale."},medals:{key:"medals",id:"X8gBJlg9E1WqK",name:"medals",description:"Pieces of stamped metal awarded for excellence or achievement or issued to commemorate a person or event, often military decorations for conduct during conflict."},negatives:{key:"negatives",id:"wKK2B5BO3aEYa",name:"negatives",description:"Photographic images, usually on transparent film or glass, with reversed tones.",esQuery:{type:"should",matchType:"match_phrase_prefix",field:"item_id_callnumber_key",values:["SLIDES","ON"]}},objects:{key:"objects",id:"7MZAw5gxmyyaW",name:"objects",description:"Three dimensional material things that can be seen and touched, includes games, coins, weapons, hair, lockets and other artefacts."},paintings:{key:"paintings",id:"0GB866Xe6mz1q",name:"paintings",description:"Pictures formed primarily by the direct application of pigment suspended in a medium, arranged in masses of colour onto a generally two-dimensional surface. The paintings in the Library’s collection are primarily documentary in nature."},photographs:{key:"photographs",id:"wKK2B5BO3aEYa",name:"photographs",description:"Pictures made using a camera, in which an image is focused on to light-sensitive material and then made visible and permanent by chemical treatment, or stored digitally.",esQuery:{type:"must_not",matchType:"match_phrase_prefix",field:"item_id_callnumber_key",values:["SLIDES","ON"]}},pictures:{key:"pictures",id:"J19GWyDjZ8Ny7",name:"pictures",description:"An image on a surface, may be formed using a variety of techniques, including drawing, painting, printing, photography."},posters:{key:"posters",id:"b10aqZK7gRzJy",name:"posters",description:"Pictorial notices made for posting in a public place to attract attention to events, activities, causes, goods, or services or to be purely decorative."},prints:{key:"prints",id:"vpkdDA18BDOdR",name:"prints",description:"Pictures formed by transfer of a medium from one surface to another, usually ink."},stamps:{key:"stamps",id:"BRg6jXK4mz4wG",name:"stamps",description:"Government-authorized hand stamps, adhesive stamps, or meter markings intended as evidence of payment of postage. Also, stamps issued by private mail delivery companies to denote payment of their delivery fees."}};var x=_;s["default"].use(y["a"]);const P=a("bc3a").default,B=2e4,E="4GiyqFNOt7ZdMZCubAdC5WVq9zGeaT8P",F="/aereo/",I="https://apiv2.sl.nsw.gov.au/collection/v1/",L="https://dxlab-fellowship-2019.s3.amazonaws.com/",S=P.create({headers:{"x-api-key":E},timeout:6e5}),T=()=>{let e=v()();return Object.entries(x).forEach(([t,a])=>{e=e.orFilter("term","medals"!==t&&"stamps"!==t&&"coin"!==t?"format_id.keyword":"subject_curated_title","medals"!==t&&"stamps"!==t&&"coin"!==t?a.id:t)}),e},N=(e,t)=>Object(g["a"])(void 0,void 0,void 0,(function*(){for(let a=0;a<e.length;a++)yield t(e[a],a,e)})),C=({query:e,esQuery:t})=>e.filter("bool",e=>(t.values.forEach(a=>{e="must_not"===t.type?e.notFilter(t.matchType,t.field,a):e.orFilter(t.matchType,t.field,a)}),e)),D=({key:e,id:t,query:a})=>{const s="medals"!==e&&"stamps"!==e&&"coin"!==e?"format_id.keyword":"subject_curated_title",n="medals"!==e&&"stamps"!==e&&"coin"!==e?t:e;return a.filter("term",s,n)},z=e=>new Promise((t,a)=>{const s=new Image;s.onload=()=>t(s),s.onerror=a,s.src=e}),R=e=>Object(g["a"])(void 0,void 0,void 0,(function*(){const t=F+"pixels/"+e.key+".png",a=yield z(t),s=document.createElement("canvas");return s.width=a.width,s.height=a.height,s.getContext("2d").drawImage(a,0,0,a.width,a.height),{pixels:s,width:a.width}})),U=e=>{const t=e.width,a=e.height,s=t*a,n=e.getContext("2d").getImageData(0,0,t,a),i=new Float32Array(t*a*3),o=new Float32Array(t*a*3),r=new Float32Array(t*a*3),l=new j["Color"];for(let c=0,d=0,u=s;c<u;c++,d+=4){l.setRGB(n.data[d]/255,n.data[d+1]/255,n.data[d+2]/255);const e={h:0,s:0,l:0};l.getHSL(e);const a=c%t,s=Math.floor(c/t),u=0;i[3*c]=a,i[3*c+1]=s,i[3*c+2]=u,o[3*c]=l.r,o[3*c+1]=l.g,o[3*c+2]=l.b,r[3*c]=e.h,r[3*c+1]=e.s,r[3*c+2]=e.l}return{colors:o,positions:i,hsls:r}},q=({hsls:e,width:t})=>{const a=e.length/3,s=[];for(let r=0,l=0;r<a;r++,l+=3)s.push({h:e[l],s:e[l+1],l:e[l+2],i:r});s.sort((e,t)=>t.h===e.h?t.l===e.l?e.s-t.s:t.l-e.l:t.h-e.h);const n=s.map(e=>e.i),i=new Float32Array(e.length),o=new Float32Array(a);return n.forEach((e,a)=>{const s=a%t,n=Math.floor(a/t),r=0;i[3*e]=s,i[3*e+1]=n,i[3*e+2]=r,o[a]=e}),{huePositions:i,hueIndexes:o}},K=e=>{const t=e.split("\n").filter(e=>""!==e),a=t.splice(0,1)[0],s=a.split(" "),n=Number(s[0]),i=Number(s[1]),o=new Float32Array(3*t.length),r=new Float32Array(n*i).fill(-1);return t.forEach((e,t)=>{const a=e.split(" "),s=Number(a[0]),i=Number(a[1]);o[3*t]=s,o[3*t+1]=i,o[3*t+2]=0,r[i*n+s]=t}),{tsneIndexes:r,tsnePositions:o}},M=(e,t)=>{const a=e.split("\n").filter(e=>""!==e),s=[],n=a.length;for(let l=0;l<n;l++)s.push({year:Number(a[l]),i:l});s.sort((e,t)=>e.year-t.year);const i=new Float32Array(3*n),o=new Float32Array(n),r=new Float32Array(n);return s.forEach((e,a)=>{const s=a%t,n=Math.floor(a/t),l=0;i[3*e.i]=s,i[3*e.i+1]=n,i[3*e.i+2]=l,o[a]=e.i,r[e.i]=e.year}),{yearIndexes:o,yearPositions:i,yearYears:r}};var G=new y["a"].Store({state:{bucketKey:null,bucketObjects:{},loadingBucket:!1,loaded:!1,confirmedAtlas:!1,fileData:{},showAtlases:!1,sort:"default",stuff:x,yearPositions:null,yearIndexes:null,yearYears:null,tsnePositions:null,tsneIndexes:null,huePositions:null,hueIndexes:null,defaultPositions:null,defaultColors:null,currentBucket:null,itemsTotal:0,loadedAtlas:0,atlases:{},pixels:{}},getters:{totalFromBuckets:e=>Object.values(e.stuff).map(e=>e.count).reduce((e,t)=>e+t,0)},actions:{getCurrentAtlases({dispatch:e,commit:t},{bucket:a,atlasCount:s}){t("setLoadedAtlas",s);for(let n=0;n<s;n++)e("getAtlasForBucketIndex",{bucket:a,index:n})},getAtlasForBucketIndex({commit:e},{bucket:t,index:a}){const s=F+"atlas/"+t.key+"_"+a+".jpg",n=new O;n.load(s,s=>{e("decreaseLoadedAtlas"),s.encoding=j["sRGBEncoding"],s.flipY=!1,e("setAtlasForBucketIndex",{bucket:t,index:a,atlas:s})})},loadFilePalette({commit:e},{id:t,url:a}){return Object(g["a"])(this,void 0,void 0,(function*(){let s=[];const n=[];try{const n=yield S.get(a),i=n.data;s=i?i.map(e=>({color:e.h,percent:Number(e.f)})):[];const o=i?i.map(e=>e.t.split(":")):[];e("setFilePalette",{id:t,palette:s,colorNames:o})}catch(i){e("setFilePalette",{id:t,palette:s,colorNames:n})}}))},loadFileImage({commit:e},{id:t,url:a}){return Object(g["a"])(this,void 0,void 0,(function*(){const s=F+"assets/not_found.svg";try{const s=yield S.get(a),n=s.data.file.image.variants["300_300"].url,i=s.data.file.title,o=yield z(n);o&&e("setFileImageTitle",{id:t,image:n,title:i})}catch(n){e("setFileImageTitle",{id:t,image:s,title:-1})}}))},loadFile({dispatch:e},{fileId:t}){const a=t;let s=I+"files/"+t;e("loadFileImage",{id:a,url:s}),s=L+"colors_minimal/"+a+".json",e("loadFilePalette",{id:a,url:s})},getBuckets({state:e,commit:t}){return Object(g["a"])(this,void 0,void 0,(function*(){const a=e.bucketKey,s=F+"counts.csv",n=yield S.get(s),i=yield k()().fromString(n.data),o={},r={};let l=0;yield N(i,t=>Object(g["a"])(this,void 0,void 0,(function*(){const s=t.bucket;if(!x[s])return;const n=Number(t.count),i=Object.assign(Object.assign({},x[s]),{count:n,key:s}),c=n<10?n:10;i.images=[];for(let e=0;e<c;e++)i.images.push(F+"images/"+s+"/"+e+".jpg");o[s]=i;const d=yield R(i);r[s]=d,a&&s===a&&(e.currentBucket=i),l+=n}))),e.stuff=o,e.pixels=r,e.itemsTotal=l,e.loaded=!0,t("updateState",e)}))},loadBucket({state:e,commit:t},a){return Object(g["a"])(this,void 0,void 0,(function*(){if(!a)return void t("setBucket",null);t("setLoadingBucket",!0);const s=F+"buckets/"+a.key+".txt",n=yield S.get(s),i=n.data,o=Object.assign(Object.assign({},e.stuff[a.id]),a);o.ids=i.split(",");const{pixels:r,width:l}=e.pixels[a.key];o.pixels=r;const{colors:c,positions:d,hsls:u}=U(o.pixels);e.defaultColors=c,e.defaultPositions=d;const{huePositions:m,hueIndexes:p}=q({hsls:u,width:l}),h=F+"similarities/"+a.key+".txt",f=yield S.get(h),g=K(f.data),{tsneIndexes:y,tsnePositions:b}=g,v=F+"years/"+a.key+".txt",w=yield S.get(v),k=M(w.data,l),{yearIndexes:j,yearPositions:A,yearYears:O}=k;e.yearPositions=A,e.yearIndexes=j,e.yearYears=O,e.tsnePositions=b,e.tsneIndexes=y,e.huePositions=m,e.hueIndexes=p,e.currentBucket=o,e.loadingBucket=!1,t("updateState",e)}))},getIdsForBucket({state:e,commit:t},a){return Object(g["a"])(this,void 0,void 0,(function*(){const s=Object({NODE_ENV:"production",VUE_APP_API_BASE_URL:"https://apiv2.sl.nsw.gov.au/collection/v1/",VUE_APP_API_KEY:"4GiyqFNOt7ZdMZCubAdC5WVq9zGeaT8P",VUE_APP_FILES_BASE_URL:"https://collection.sl.nsw.gov.au/digital/file/",VUE_APP_S3_BASE_URL:"https://dxlab-fellowship-2019.s3.amazonaws.com/",VUE_APP_FINAL_URL:"https://dxlab.sl.nsw.gov.au/aereo/",BASE_URL:"/aereo/"}).VUE_APP_ELASTIC_BASE_URL+"_search",n=a.key,i=a.id,o=a.count,r=Math.ceil(o/B),l=new Array(r),c={track_total_hits:!0};let d=[];yield N(l,(e,t)=>Object(g["a"])(this,void 0,void 0,(function*(){let e=T().size(B).from(t*B).rawOption("_source","_id");e=D({key:n,id:i,query:e});const o=a.esQuery;o&&(e=C({query:e,esQuery:o}));const r=yield S.post(s,Object.assign(Object.assign({},e.build()),c)),l=r.data.hits;d=d.concat(l.hits.map(e=>e._id))})));const u=Object.assign(Object.assign({},a),{data:[...d]});let m=Object.assign({},e.stuff);m=Object.assign(Object.assign({},m),{[n]:u});const p=Object.assign({},m);t("updateState",Object.assign(Object.assign({},e),{stuff:p}))}))}},mutations:{setFileImageTitle:(e,{id:t,image:a,title:s})=>{if(t!==e.fileData["id"])return;const n=Object.assign(Object.assign({},e.fileData),{image:a,title:s});e.fileData=n},setFilePalette:(e,{id:t,palette:a,colorNames:s})=>{if(t!==e.fileData["id"])return;const n=Object.assign(Object.assign({},e.fileData),{palette:a,colorNames:s});e.fileData=n},setBucketKey:(e,t)=>e.bucketKey=t,setLoadingBucket:(e,t)=>e.loadingBucket=t,setBucketObjects:(e,t)=>e.bucketObjects=t,updateState:(e,t)=>Object.assign(Object.assign({},e),t),setConfirmedAtlas:e=>e.confirmedAtlas=!0,setShowAtlases:(e,t)=>e.showAtlases=t,setSort:(e,t)=>{t||(t="default"),e.sort=t},setLoadedAtlas:(e,t)=>{e.loadedAtlas=t},decreaseLoadedAtlas:e=>{e.loadedAtlas--},setAtlasForBucketIndex:(e,{bucket:t,index:a,atlas:s})=>{const n=Object.assign({},e.atlases);let i;i=n[t.key]?[...n[t.key]]:[],i[a]=s,n[t.key]=i,e.atlases=n},setFileData:(e,t)=>e.fileData=t,setStuff:(e,t)=>e.stuff=t,setBucket:(e,t)=>e.currentBucket=t},modules:{}});s["default"].config.productionTip=!1,s["default"].use(i.a),new s["default"]({router:f,store:G,render:e=>e(u)}).$mount("#app")}});
//# sourceMappingURL=index.d5693d17.js.map